<!-- app/templates/base.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}A Different Path{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">
</head>
<body>
  <header class="topbar">
    <div class="container topbar__inner">
      <a class="brand" href="{{ url_for('site.home') }}">
        <img class="brand__logo" src="{{ url_for('static', filename='img/logo.png') }}" alt="A Different Path logo">
        <span class="brand__name">A Different Path</span>
      </a>

    <nav class="nav" aria-label="Primary">
    <!-- Mobile toggle -->
    <button class="nav__toggle" type="button" id="navToggle"
            aria-expanded="false" aria-controls="navPanel">
        <span class="nav__toggleBars" aria-hidden="true"></span>
        <span class="nav__toggleText">Menu</span>
    </button>

    <!-- Panel -->
    <div class="nav__panel" id="navPanel">
        <a class="nav__link {{ 'is-active' if active=='home' else '' }}" href="{{ url_for('site.home') }}">Home</a>

        <!-- WHO (desktop dropdown + mobile accordion) -->
        <div class="nav__drop" data-drop>
        <button class="nav__link nav__dropBtn {{ 'is-active' if active=='who' else '' }}"
                type="button" aria-expanded="false" aria-controls="whoMenu" id="whoBtn">
            Who <span class="nav__chev">▾</span>
        </button>

        <div class="nav__menu" id="whoMenu">
            <a class="nav__item" href="{{ url_for('site.who_we_are') }}">Who We Are</a>
            <a class="nav__item" href="{{ url_for('site.who_guides_us') }}">Who Guides Us</a>
            <a class="nav__item" href="{{ url_for('site.who_serves_you') }}">Who Serves You</a>
            <a class="nav__item" href="{{ url_for('site.who_we_rockin_with') }}">View Partners</a>
        </div>
        </div>

        <a class="nav__link {{ 'is-active' if active=='support' else '' }}" href="{{ url_for('site.get_started') }}">How We Support</a>
        <a class="nav__link {{ 'is-active' if active=='faqs' else '' }}" href="{{ url_for('site.faqs') }}">FAQs</a>

        <a class="nav__cta" href="{{ url_for('site.get_started') }}">Get Started</a>
    </div>
    </nav>


    </div>
  </header>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="container flashes">
        {% for category, msg in messages %}
          <div class="flash flash--{{ category }}">{{ msg }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <main>
    {% block content %}{% endblock %}
  </main>

  {% include "partials/footer.html" %}

    <!-- Floating Quick Links -->
    <div class="fab" id="fab" data-state="closed">
    <button class="fab__pill" id="fabToggle" type="button" aria-expanded="false" aria-controls="fabPanel">
        <span class="fab__pillIcon" aria-hidden="true">
        <!-- sparkle icon -->
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2l1.2 4.2L17.4 8 13.2 9.2 12 13.4 10.8 9.2 6.6 8l4.2-1.8L12 2z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
            <path d="M19 12l.8 2.6L22 16l-2.2.7L19 19l-.8-2.3L16 16l2.2-.7L19 12z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
        </svg>
        </span>
        <span class="fab__pillText">Quick Links</span>
        <span class="fab__pillChev" aria-hidden="true">▾</span>
    </button>

    <div class="fab__panel" id="fabPanel" hidden>
        <a class="fab__link" href="{{ VOLUNTEER_URL }}" target="_blank" rel="noopener">
        <span class="fab__linkIcon" aria-hidden="true">
            <!-- heart/hand -->
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 21s-7-4.4-9.2-8.5C1.4 9.4 3.5 6.8 6.4 6.8c1.6 0 2.8.8 3.6 1.8.8-1 2-1.8 3.6-1.8 2.9 0 5 2.6 3.6 5.7C19 16.6 12 21 12 21z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
            </svg>
        </span>
        Volunteer
        </a>

        <a class="fab__link fab__link--primary" href="{{ GET_STARTED_URL }}" target="_blank" rel="noopener">
        <span class="fab__linkIcon" aria-hidden="true">
            <!-- arrow -->
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 12h12" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M13 6l6 6-6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </span>
        Get Started
        </a>

        <a class="fab__link" href="{{ INSTAGRAM_URL }}" target="_blank" rel="noopener">
        <span class="fab__linkIcon" aria-hidden="true">
            <!-- instagram-ish -->
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="6" y="6" width="12" height="12" rx="3" stroke="currentColor" stroke-width="1.6"/>
            <path d="M12 10.3a1.7 1.7 0 1 0 0 3.4 1.7 1.7 0 0 0 0-3.4z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.3 7.8h.1" stroke="currentColor" stroke-width="2.6" stroke-linecap="round"/>
            </svg>
        </span>
        Instagram
        </a>

        <a class="fab__link" href="{{ DONATE_URL }}" target="_blank" rel="noopener">
        <span class="fab__linkIcon" aria-hidden="true">
            <!-- coin -->
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="12" cy="8" rx="7" ry="3" stroke="currentColor" stroke-width="1.6"/>
            <path d="M5 8v8c0 1.7 3.1 3 7 3s7-1.3 7-3V8" stroke="currentColor" stroke-width="1.6"/>
            </svg>
        </span>
        Donate
        </a>

        <a class="fab__link fab__link--ghost" href="{{ url_for('site.faqs') }}">
  <span class="fab__linkIcon" aria-hidden="true">
    <!-- question mark -->
    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 17h.01" stroke="currentColor" stroke-width="2.6" stroke-linecap="round"/>
      <path d="M9.5 9a2.5 2.5 0 1 1 3.8 2.1c-.9.5-1.3 1-1.3 1.9V14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M12 21a9 9 0 1 0-9-9 9 9 0 0 0 9 9Z" stroke="currentColor" stroke-width="1.6"/>
    </svg>
  </span>
  FAQs
</a>
</div>
    </div>

    <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true">
        <div class="toast__title" id="toastTitle">Opening form…</div>
        <div class="toast__msg" id="toastMsg">You’ll be redirected in a new tab.</div>
    </div>


    <script>
  (function () {
    const fab = document.getElementById('fab');
    const toggle = document.getElementById('fabToggle');
    const panel = document.getElementById('fabPanel');
    if (!fab || !toggle || !panel) return;

    const KEY = "adp_fab_open";

    function setOpen(open, persist = true) {
      toggle.setAttribute('aria-expanded', String(open));
      panel.hidden = !open;
      fab.dataset.state = open ? 'open' : 'closed';
      if (persist) localStorage.setItem(KEY, open ? "1" : "0");
    }

    // Close when clicking any link
    panel.querySelectorAll('a').forEach(a => {
      a.addEventListener('click', () => setOpen(false));
    });

    // Restore state
    try {
      const saved = localStorage.getItem(KEY);
      if (saved === "1") setOpen(true, false);
    } catch (e) {}

    toggle.addEventListener('click', () => {
      const isOpen = toggle.getAttribute('aria-expanded') === 'true';
      setOpen(!isOpen);
    });

    // Close on outside click
    document.addEventListener('click', (e) => {
      if (!fab.contains(e.target)) setOpen(false);
    });

    // Close on escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') setOpen(false);
    });
  })();

  (function () {
    const els = document.querySelectorAll('.reveal');
    if (!els.length) return;

    if (!('IntersectionObserver' in window)) {
      els.forEach(e => e.classList.add('is-visible'));
      return;
    }

    const io = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          io.unobserve(entry.target);
        }
      });
    }, { threshold: 0.12 });

    els.forEach(e => io.observe(e));
  })();

  // Dialog helpers (Board/Directors popups)
  (function(){
    document.addEventListener('click', (e) => {
      const openBtn = e.target.closest('[data-dialog-open]');
      if (openBtn) {
        const id = openBtn.getAttribute('data-dialog-open');
        const dlg = document.getElementById(id);
        if (dlg && typeof dlg.showModal === 'function') dlg.showModal();
      }

      const closeBtn = e.target.closest('[data-dialog-close]');
      if (closeBtn) {
        const dlg = closeBtn.closest('dialog');
        if (dlg) dlg.close();
      }
    });
  })();
</script>


    <script>
    (function(){
    const toggle = document.getElementById('navToggle');
    const panel  = document.getElementById('navPanel');
    const whoBtn = document.getElementById('whoBtn');
    const whoMenu= document.getElementById('whoMenu');

    if (!toggle || !panel) return;

    function setNav(open){
        toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        panel.classList.toggle('is-open', open);
        document.body.classList.toggle('nav-open', open);
        if (!open) {
        // close Who submenu too
        if (whoBtn && whoMenu){
            whoBtn.setAttribute('aria-expanded', 'false');
            whoMenu.classList.remove('is-open');
        }
        }
    }

    toggle.addEventListener('click', () => {
        const open = toggle.getAttribute('aria-expanded') !== 'true';
        setNav(open);
    });

    // Mobile: tap-to-open Who
    if (whoBtn && whoMenu){
        whoBtn.addEventListener('click', () => {
        const open = whoBtn.getAttribute('aria-expanded') !== 'true';
        whoBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
        whoMenu.classList.toggle('is-open', open);
        });
    }

    // Close panel on link click (mobile)
    panel.addEventListener('click', (e) => {
        const a = e.target.closest('a');
        if (a && window.matchMedia('(max-width: 860px)').matches){
        setNav(false);
        }
    });

    // Escape closes
    window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') setNav(false);
    });
    })();
    </script>


</body>
</html>
